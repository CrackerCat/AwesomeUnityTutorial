# C# 事件系统

## 1. 委托 Delegate

Delegate 是 C# 中的一种系统内置的对象类型，用来存储并指向指定了格式的方法。

类似于 “指定格式方法的引用” 或 “存放指定格式方法的容器”，就像是基础数据类型定义的变量，可以用来存储相同格式的不同方法

### 相同格式的方法

满足下面两个条件的方法，就可以称为“相同格式”的方法

* 返回值类型相同
* 参数列表相同：参数类型、个数、顺序必须都相同，但不要求参数名相同

### 1.1 委托的定义

在 C# 中，可以使用关键字 ： delegate 声明或定义一个委托类型

``` C#
// 委托定义格式
public delegate 方法返回值类型 委托类型名(参数列表);
```

### 1.2 委托的基本使用

C# 中委托的用途，就是来存储方法，跟普通变量的使用方式基本相同，但是要注意，委托是“引用类型”，而非“值类型”

``` C#
// 委托的使用

// 创建一个和委托同格式的方法

方法返回值类型 方法名(形参列表){
    方法内语句段....
}

// 委托对象赋值
委托类型名 委托对象名 = 具体的某个方法名;
// 调用委托所存储（指向）的方法
委托对象名(实参列表);

```

### 1.3 委托基本使用具体实例

创建一个委托类型，用来引用两个对应类型的方法，并使用委托执行方法

``` C#
public class DelegateTest : MonoBehaviour
{
    //创建委托，用来存储（指向）打招呼用的方法
    public delegate void SayHiDelegate(string name);
    
    // Start is called before the first frame update
    void Start()
    {
        //使用委托类型创建委托对象，引用具体方法
        SayHiDelegate sayHi = SayHiInEn;
        //用委托对象执行所引用的方法
        sayHi("Richard");
        
        sayHi = SayHiInCn;
        sayHi("郭靖");
    }

    //自定义打招呼方法1，讲英文
    void SayHiInEn(string name)
    {
        Debug.Log($"Hi！{name}");
    }
    
    //自定义打招呼方法2，讲中文
    void SayHiInCn(string name)
    {
        Debug.Log($"{name}，吃了没~");
    }
}

```

### 1.4 委托进阶使用

自然，委托对象也可以作为方法的参数来使用

这里，我们直接来看例子，上面的代码的进阶版：

``` C#
public class DelegateTest1 : MonoBehaviour
{
    //创建委托，用来存储（指向）打招呼用的方法
    public delegate void SayHiDelegate(string name);
    
    // Start is called before the first frame update
    void Start()
    {
        //委托对象作为参数，实参就是具体的方法（同格式）
        SayHi("Richard",SayHiInEn);
        
        SayHi("郭靖",SayHiInCn);
    }

    //创建一个方法，使用委托对象作为参数
    void SayHi(string name,SayHiDelegate method)
    {
        //使用委托调用引用的方法
        method(name);
    }

    //自定义打招呼方法1，讲英文
    void SayHiInEn(string name)
    {
        Debug.Log($"Hi！{name}");
    }
    
    //自定义打招呼方法2，讲中文
    void SayHiInCn(string name)
    {
        Debug.Log($"{name}，吃了没~");
    }
}
```